<!DOCTYPE html>
<!--
Mission Center Web Interface - Modular Components Version
-->
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Mission Center · Web</title>
    <link rel="stylesheet" href="/css/styles.css" />
    <!-- Lucide Icons - Professional icon library -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js" defer></script>
    <script src="/js/app.js" type="module" defer></script>
</head>
<body>
    <aside class="sidebar">
        <h2><i data-lucide="monitor"></i> Mission Center</h2>
        <div class="nav-item active" data-section="overview">
            <i data-lucide="layout-dashboard"></i> Resumen
        </div>
        <div class="nav-item" data-section="performance">
            <i data-lucide="zap"></i> Rendimiento
        </div>
        <div class="nav-item" data-section="analytics">
            <i data-lucide="trending-up"></i> Analítica
        </div>
        <div class="nav-item" data-section="processes">
            <i data-lucide="activity"></i> Procesos
        </div>
        <div class="nav-item" data-section="sensors">
            <i data-lucide="thermometer"></i> Sensores
        </div>
        <div class="nav-item" data-section="system">
            <i data-lucide="settings"></i> Sistema
        </div>
    </aside>
    
    <main class="main-content">
        <!-- Dashboard Section -->
        <section id="overview" class="interactive-dashboard">
            <!-- Dashboard Toolbar -->
            <div class="dashboard-toolbar">
                <div class="toolbar-left">
                    <h2><i data-lucide="layout-dashboard"></i> Dashboard Personalizable</h2>
                </div>
                <div class="toolbar-right">
                    <button class="btn-icon" id="add-widget-btn" title="Añadir Widget">
                        <i data-lucide="plus"></i>
                    </button>
                    <button class="btn-icon" id="layout-reset-btn" title="Resetear Layout">
                        <i data-lucide="refresh-cw"></i>
                    </button>
                    <button class="btn-icon" id="dashboard-settings-btn" title="Configuración">
                        <i data-lucide="settings"></i>
                    </button>
                </div>
            </div>

            <!-- Interactive Widget Grid -->
            <div class="widgets-grid" id="widgets-container">
                <!-- CPU Widget -->
                <div class="widget widget-base widget-medium" data-widget-id="cpu" data-widget-type="cpu" data-can-resize="true" data-grid-column-span="1" data-grid-row-span="1" draggable="true">
                    <div class="widget-header">
                        <h3><i data-lucide="cpu"></i> CPU</h3>
                        <div class="widget-controls">
                            <button class="widget-btn" data-action="resize" title="Redimensionar">
                                <i data-lucide="maximize-2"></i>
                            </button>
                            <button class="widget-btn" data-action="remove" title="Eliminar">
                                <i data-lucide="x"></i>
                            </button>
                        </div>
                    </div>
                    <div class="widget-content">
                        <div class="metric-grid">
                            <div class="metric">
                                <div class="metric-label">Uso Total</div>
                                <div class="metric-value" data-metric="cpu-usage">--</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">Frecuencia</div>
                                <div class="metric-value" data-metric="cpu-freq">--</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">Núcleos Lógicos</div>
                                <div class="metric-value" data-metric="cpu-cores">--</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">Núcleos Físicos</div>
                                <div class="metric-value" data-metric="cpu-physical">--</div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="cpuChart"></canvas>
                        </div>
                    </div>
                    <div class="resize-handles">
                        <div class="resize-handle resize-se"></div>
                    </div>
                </div>

                <!-- Memory Widget -->
                <div class="widget widget-base widget-medium" data-widget-id="memory" data-widget-type="memory" data-can-resize="true" data-grid-column-span="1" data-grid-row-span="1" draggable="true">
                    <div class="widget-header">
                        <h3><i data-lucide="memory-stick"></i> Memoria</h3>
                        <div class="widget-controls">
                            <button class="widget-btn" data-action="resize" title="Redimensionar">
                                <i data-lucide="maximize-2"></i>
                            </button>
                            <button class="widget-btn" data-action="remove" title="Eliminar">
                                <i data-lucide="x"></i>
                            </button>
                        </div>
                    </div>
                    <div class="widget-content">
                        <div class="metric-grid">
                            <div class="metric">
                                <div class="metric-label">RAM usada</div>
                                <div class="metric-value" data-metric="mem-usage">--</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">RAM total</div>
                                <div class="metric-value" data-metric="mem-total">--</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">Swap usada</div>
                                <div class="metric-value" data-metric="swap-usage">--</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">Swap total</div>
                                <div class="metric-value" data-metric="swap-total">--</div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="memoryChart"></canvas>
                        </div>
                    </div>
                    <div class="resize-handles">
                        <div class="resize-handle resize-se"></div>
                    </div>
                </div>

                <!-- Storage Widget -->
                <div class="widget widget-base widget-medium" data-widget-id="storage" data-widget-type="storage" data-can-resize="true" data-grid-column-span="1" data-grid-row-span="1" draggable="true">
                    <div class="widget-header">
                        <h3><i data-lucide="hard-drive"></i> Almacenamiento</h3>
                        <div class="widget-controls">
                            <button class="widget-btn" data-action="resize" title="Redimensionar">
                                <i data-lucide="maximize-2"></i>
                            </button>
                            <button class="widget-btn" data-action="remove" title="Eliminar">
                                <i data-lucide="x"></i>
                            </button>
                        </div>
                    </div>
                    <div class="widget-content">
                        <div class="metric-grid">
                            <div class="metric">
                                <div class="metric-label">Lectura</div>
                                <div class="metric-value" data-metric="disk-read">--</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">Escritura</div>
                                <div class="metric-value" data-metric="disk-write">--</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">Dispositivos</div>
                                <div class="metric-value" data-metric="disk-count">--</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">E/S total</div>
                                <div class="metric-value" data-metric="io-total">--</div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="diskChart"></canvas>
                        </div>
                    </div>
                    <div class="resize-handles">
                        <div class="resize-handle resize-se"></div>
                    </div>
                </div>

                <!-- Network Widget -->
                <div class="widget widget-base widget-medium" data-widget-id="network" data-widget-type="network" data-can-resize="true" data-grid-column-span="1" data-grid-row-span="1" draggable="true">
                    <div class="widget-header">
                        <h3><i data-lucide="network"></i> Red</h3>
                        <div class="widget-controls">
                            <button class="widget-btn" data-action="resize" title="Redimensionar">
                                <i data-lucide="maximize-2"></i>
                            </button>
                            <button class="widget-btn" data-action="remove" title="Eliminar">
                                <i data-lucide="x"></i>
                            </button>
                        </div>
                    </div>
                    <div class="widget-content">
                        <div class="metric-grid">
                            <div class="metric">
                                <div class="metric-label">Subida</div>
                                <div class="metric-value" data-metric="net-sent">--</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">Bajada</div>
                                <div class="metric-value" data-metric="net-recv">--</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">Interfaces</div>
                                <div class="metric-value" data-metric="net-interfaces">--</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">GPUs</div>
                                <div class="metric-value" data-metric="gpu-count">--</div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="networkChart"></canvas>
                        </div>
                    </div>
                    <div class="resize-handles">
                        <div class="resize-handle resize-se"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Performance Section -->
        <section id="performance" class="hidden">
            <article class="card full-width">
                <h3><i data-lucide="flame"></i> CPU por núcleo</h3>
                <div class="cores-grid" id="cpu-cores-grid"></div>
            </article>
            <article class="card full-width">
                <h3><i data-lucide="zap"></i> GPUs</h3>
                <div id="gpu-cards-grid" class="gpu-cards-grid">
                    <!-- GPU cards will be dynamically populated -->
                </div>
            </article>
            <article class="card full-width">
                <h3><i data-lucide="activity"></i> I/O por dispositivo</h3>
                <div id="io-devices-grid" class="io-devices-grid">
                    <!-- I/O device cards will be dynamically populated -->
                </div>
            </article>
        </section>

        <!-- Analytics Section -->
        <section id="analytics" class="hidden">
            <article class="card full-width">
                <h3><i data-lucide="bar-chart-3"></i> Actividad de discos</h3>
                <div class="chart-container">
                    <canvas id="diskReadChart"></canvas>
                </div>
                <div class="chart-container" style="margin-top: 24px;">
                    <canvas id="diskWriteChart"></canvas>
                </div>
            </article>
        </section>

        <!-- Processes Section -->
        <section id="processes" class="hidden">
            <div class="process-table">
                <div class="table-header">
                    <div>PID</div>
                    <div>Nombre</div>
                    <div>CPU %</div>
                    <div>Memoria</div>
                    <div>Usuario</div>
                </div>
                <div id="processes-list"></div>
            </div>
        </section>

        <!-- Sensors Section -->
        <section id="sensors" class="hidden">
            <article class="card">
                <h3><i data-lucide="thermometer"></i> Temperaturas</h3>
                <div class="chart-container">
                    <canvas id="tempChart"></canvas>
                </div>
                <table class="sensor-table" id="temp-table"></table>
            </article>
            <article class="card">
                <h3><i data-lucide="wind"></i> Ventiladores</h3>
                <div class="chart-container">
                    <canvas id="fanChart"></canvas>
                </div>
                <table class="sensor-table" id="fan-table"></table>
            </article>
            <article class="card">
                <h3><i data-lucide="battery"></i> Energía</h3>
                <div class="sensor-grid">
                    <div class="system-card">
                        <h4>Batería</h4>
                        <dl id="battery-info"></dl>
                    </div>
                    <div class="system-card">
                        <h4>Fuentes de energía</h4>
                        <table class="sensor-table" id="power-table"></table>
                    </div>
                </div>
            </article>
        </section>

        <!-- System Section -->
        <section id="system" class="hidden">
            <article class="card">
                <h3><i data-lucide="link"></i> Estado de Conexión</h3>
                <div class="status-bar" role="status" aria-live="polite">
                    <div class="status-pill" id="status-pill">
                        <span class="status-indicator" id="status-indicator" aria-hidden="true"></span>
                        <span id="status-text">Conectando...</span>
                    </div>
                    <div class="status-meta">
                        <div>
                            <span class="status-label">Actualización</span>
                            <span class="status-value" id="last-update">--:--:--</span>
                        </div>
                        <div>
                            <span class="status-label">Permisos</span>
                            <span class="status-value permissions-indicator" id="permissions-indicator">🔒 Verificando...</span>
                        </div>
                    </div>
                </div>
            </article>
            
            <article class="card">
                <h3><i data-lucide="settings"></i> Información del Sistema</h3>
                <div class="system-meta-grid">
                    <div>
                        <span class="status-label">Tiempo activo</span>
                        <span class="status-value" id="uptime-value">--</span>
                    </div>
                    <div>
                        <span class="status-label">Host</span>
                        <span class="status-value" id="host-name">--</span>
                    </div>
                    <div>
                        <span class="status-label">Sistema Operativo</span>
                        <span class="status-value" id="os-name">--</span>
                    </div>
                </div>
                <div class="system-grid" id="system-info"></div>
            </article>
            
            <article class="card">
                <h3><i data-lucide="cable"></i> PCI Express</h3>
                <table class="sensor-table" id="pcie-table"></table>
            </article>
        </section>
    </main>

    <!-- Widget Selection Modal -->
    <div class="modal" id="widget-selector-modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i data-lucide="plus-square"></i> Añadir Nuevo Widget</h3>
                <button class="modal-close" id="close-widget-modal">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="widget-categories">
                    <div class="category-section">
                        <h4><i data-lucide="activity"></i> Rendimiento</h4>
                        <div class="widget-options">
                            <div class="widget-option" data-widget-type="cpu">
                                <div class="widget-preview">
                                    <i data-lucide="cpu"></i>
                                    <span>CPU</span>
                                </div>
                                <p>Monitoreo de procesador en tiempo real</p>
                            </div>
                            <div class="widget-option" data-widget-type="memory">
                                <div class="widget-preview">
                                    <i data-lucide="memory-stick"></i>
                                    <span>Memoria</span>
                                </div>
                                <p>RAM y Swap del sistema</p>
                            </div>
                            <div class="widget-option" data-widget-type="gpu">
                                <div class="widget-preview">
                                    <i data-lucide="zap"></i>
                                    <span>GPU</span>
                                </div>
                                <p>Tarjetas gráficas del sistema</p>
                            </div>
                        </div>
                    </div>

                    <div class="category-section">
                        <h4><i data-lucide="hard-drive"></i> Almacenamiento & Red</h4>
                        <div class="widget-options">
                            <div class="widget-option" data-widget-type="storage">
                                <div class="widget-preview">
                                    <i data-lucide="hard-drive"></i>
                                    <span>Almacenamiento</span>
                                </div>
                                <p>Actividad de discos y E/S</p>
                            </div>
                            <div class="widget-option" data-widget-type="network">
                                <div class="widget-preview">
                                    <i data-lucide="network"></i>
                                    <span>Red</span>
                                </div>
                                <p>Tráfico de red e interfaces</p>
                            </div>
                        </div>
                    </div>

                    <div class="category-section">
                        <h4><i data-lucide="list"></i> Procesos & Sistema</h4>
                        <div class="widget-options">
                            <div class="widget-option" data-widget-type="processes">
                                <div class="widget-preview">
                                    <i data-lucide="list"></i>
                                    <span>Procesos</span>
                                </div>
                                <p>Procesos activos del sistema</p>
                            </div>
                            <div class="widget-option" data-widget-type="sensors">
                                <div class="widget-preview">
                                    <i data-lucide="thermometer"></i>
                                    <span>Sensores</span>
                                </div>
                                <p>Temperaturas y ventiladores</p>
                            </div>
                            <div class="widget-option" data-widget-type="system-info">
                                <div class="widget-preview">
                                    <i data-lucide="info"></i>
                                    <span>Sistema</span>
                                </div>
                                <p>Información del sistema</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-widget-add">Cancelar</button>
                <button class="btn btn-primary" id="confirm-widget-add" disabled>Añadir Widget</button>
            </div>
        </div>
    </div>

    <!-- Drop Zone Indicator -->
    <div class="drop-zone-indicator" id="drop-indicator" style="display: none;">
        <i data-lucide="plus"></i>
        <span>Soltar widget aquí</span>
    </div>

    <script>
        // Initialize Lucide icons after page load
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        });
    </script>
</body>
</html>